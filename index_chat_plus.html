<!doctype html>
<html lang="de" class="h-full scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Red ma Kärntnerisch! – Prototype (Übersetzer + Dialekt‑Chat)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="color-scheme" content="light dark">
  <style>
    :root { --ring: 240 5% 64%; }
    .glass { @apply bg-white/70 dark:bg-gray-900/40 backdrop-blur; }
    .card { @apply rounded-3xl border shadow-sm; }
    .ringed { box-shadow: 0 0 0 1px hsl(var(--ring)); }
    .accent-gradient {
      background-image: radial-gradient(40% 60% at 10% 10%, rgba(251,191,36,.35) 0, rgba(251,191,36,0) 60%),
                        radial-gradient(40% 60% at 90% 20%, rgba(52,211,153,.35) 0, rgba(52,211,153,0) 60%),
                        radial-gradient(40% 60% at 15% 90%, rgba(56,189,248,.35) 0, rgba(56,189,248,0) 60%);
    }
    .grid-bg {
      background-image:
        linear-gradient(to right, rgb(0 0 0 / .04) 1px, transparent 1px),
        linear-gradient(to bottom, rgb(0 0 0 / .04) 1px, transparent 1px);
      background-size: 24px 24px;
    }
    .dark .grid-bg {
      background-image:
        linear-gradient(to right, rgb(255 255 255 / .06) 1px, transparent 1px),
        linear-gradient(to bottom, rgb(255 255 255 / .06) 1px, transparent 1px);
    }
    .shine:hover { transform: translateY(-1px); }
    .underline-wavy { text-decoration-line: underline; text-decoration-style: wavy; text-decoration-thickness: 3px; text-underline-offset: 6px; }
    .tab-active { border-color: rgb(251 191 36/1); background-color: rgb(254 243 199/0.6); }
    .badge { @apply inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium bg-white/60 dark:bg-gray-900/30; }
  </style>
</head>
<body class="min-h-screen bg-white text-gray-900 dark:bg-gray-950 dark:text-gray-100 accent-gradient">
  <!-- Decorative blobs -->
  <div class="pointer-events-none fixed inset-0 -z-10">
    <div class="absolute -top-20 -left-24 h-72 w-72 rounded-full bg-amber-300/20 blur-3xl"></div>
    <div class="absolute top-40 -right-24 h-72 w-72 rounded-full bg-emerald-300/20 blur-3xl"></div>
    <div class="absolute bottom-10 left-1/2 -translate-x-1/2 h-72 w-96 rounded-full bg-sky-300/20 blur-3xl"></div>
  </div>

  <!-- Top Nav -->
  <header class="sticky top-0 z-40 w-full border-b backdrop-blur bg-white/70 dark:bg-gray-900/60">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <span class="inline-flex h-8 w-8 items-center justify-center rounded-xl bg-gradient-to-br from-amber-400 via-emerald-400 to-sky-400 text-gray-900 font-extrabold">R</span>
        <span class="text-lg sm:text-xl font-extrabold">Red ma Kärntnerisch!</span>
        <span class="hidden sm:inline-flex items-center rounded-full border px-2 py-0.5 text-xs font-medium">Prototype</span>
      </div>
      <nav class="hidden md:flex items-center gap-2 text-sm">
        <a href="#demo" class="px-3 py-1.5 rounded-full border hover:bg-gray-50 dark:hover:bg-gray-800">Live‑Demo</a>
        <a href="#features" class="px-3 py-1.5 rounded-full border hover:bg-gray-50 dark:hover:bg-gray-800">Features</a>
        <a href="#technik" class="px-3 py-1.5 rounded-full border hover:bg-gray-50 dark:hover:bg-gray-800">Technik</a>
        <a href="#evaluation" class="px-3 py-1.5 rounded-full border hover:bg-gray-50 dark:hover:bg-gray-800">Evaluation</a>
        <a href="#privacy" class="px-3 py-1.5 rounded-full border hover:bg-gray-50 dark:hover:bg-gray-800">Datenschutz</a>
      </nav>
      <button id="darkToggle" class="rounded-full border px-3 py-1.5 text-xs font-semibold hover:bg-gray-50 dark:hover:bg-gray-800">Dark Mode</button>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative overflow-hidden grid-bg">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-16 sm:py-24">
      <div class="grid lg:grid-cols-12 gap-10 items-center">
        <div class="lg:col-span-7">
          <p class="inline-flex items-center gap-2 text-xs font-semibold tracking-wider uppercase text-gray-500">
            <span class="h-1.5 w-1.5 rounded-full bg-amber-400"></span> Bachelorprojekt – FH Kärnten
          </p>
          <h1 class="mt-3 text-4xl sm:text-6xl font-extrabold tracking-tight leading-[1.05]">
            KI‑Chatbot für den <span class="underline-wavy decoration-amber-400">Kärntner Dialekt</span>
          </h1>
          <p class="mt-5 text-base sm:text-lg text-gray-600 dark:text-gray-300 max-w-2xl">
            Hochdeutsch rein – Kärntnerisch raus. Schriftlich und gesprochen. Forschung trifft Praxis. Echtzeit‑Pipeline mit STT, LLM‑Regeln und TTS.
          </p>

          <div class="mt-6 flex flex-wrap gap-2">
            <span class="badge">LLM + Regelwerk</span>
            <span class="badge">STT: Whisper</span>
            <span class="badge">TTS: ElevenLabs</span>
            <span class="badge">Frontend: Static</span>
          </div>

          <div class="mt-8 flex flex-wrap gap-3">
            <a href="#demo" class="shine transition rounded-2xl px-5 py-2.5 border text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800">Live‑Demo öffnen</a>
            <a href="#technik" class="shine transition rounded-2xl px-5 py-2.5 border text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800">Technik anschauen</a>
          </div>
        </div>

        <div class="lg:col-span-5">
          <div class="card glass ringed p-5">
            <div class="text-xs uppercase tracking-wider text-gray-500">Use‑Cases</div>
            <div class="mt-3 grid grid-cols-2 gap-3 text-sm">
              <div class="card p-4 glass">
                <div class="font-semibold">Sprachkultur</div>
                <p class="mt-1 text-gray-600 dark:text-gray-300">Dialekt bewahren & erlebbar machen.</p>
              </div>
              <div class="card p-4 glass">
                <div class="font-semibold">Tourismus</div>
                <p class="mt-1 text-gray-600 dark:text-gray-300">Lokale Infos im Dialekt.</p>
              </div>
              <div class="card p-4 glass">
                <div class="font-semibold">Bildung</div>
                <p class="mt-1 text-gray-600 dark:text-gray-300">Dialekt im Unterricht vermitteln.</p>
              </div>
              <div class="card p-4 glass">
                <div class="font-semibold">Accessibility</div>
                <p class="mt-1 text-gray-600 dark:text-gray-300">Niedrigere Barrieren zu Services.</p>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <svg class="absolute bottom-0 left-0 right-0" viewBox="0 0 1440 80" xmlns="http://www.w3.org/2000/svg">
      <path fill="currentColor" class="text-white dark:text-gray-950" d="M0,64L48,58.7C96,53,192,43,288,42.7C384,43,480,53,576,64C672,75,768,85,864,69.3C960,53,1056,11,1152,10.7C1248,11,1344,53,1392,74.7L1440,96L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z"/>
    </svg>
  </section>

  <!-- Live Demo with Tabs -->
  <section id="demo" class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
    <div class="flex items-center justify-between gap-4 mb-6">
      <h2 class="text-2xl sm:text-3xl font-bold tracking-tight">Live‑Demo</h2>
      <span class="inline-flex items-center gap-2 text-xs font-medium text-gray-500">
        <span class="h-1.5 w-1.5 rounded-full bg-emerald-400 animate-pulse"></span> Mock · Kein Backend
      </span>
    </div>
    <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Zwei Modi: <strong>Übersetzer</strong> (HD → Dialekt) und <strong>Dialekt‑Chat</strong> (logische Antworten im Dialekt).</p>

    <div class="mt-6">
      <!-- Tabs -->
      <div class="flex gap-2">
        <button id="tabTrans" class="tab-btn rounded-full border px-4 py-2 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800 tab-active">Übersetzer</button>
        <button id="tabChat" class="tab-btn rounded-full border px-4 py-2 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800">Dialekt‑Chat</button>
      </div>

      <!-- Panels -->
      <div class="mt-4">
        <!-- Panel: Übersetzer -->
        <div id="panelTrans">
          <div class="grid md:grid-cols-2 gap-6">
            <!-- Translator Chat -->
            <div class="rounded-3xl border shadow-sm overflow-hidden bg-white/70 dark:bg-gray-900/40">
              <div class="p-4 border-b bg-gray-50/60 dark:bg-gray-900/40 flex items-center justify-between">
                <div class="font-semibold">Übersetzer</div>
                <div class="text-xs text-gray-500">Enter = senden</div>
              </div>
              <div id="messages" class="p-4 space-y-3 max-h-[380px] overflow-auto">
                <div class="mx-auto text-xs text-gray-500">Schreib auf Hochdeutsch. Ich antworte im Kärntner Dialekt (wörtliche Übersetzung).</div>
              </div>
              <div class="p-3 border-t bg-white/60 dark:bg-gray-900/40">
                <div class="flex gap-2">
                  <textarea id="input" placeholder="Schreib auf Hochdeutsch …"
                    class="flex-1 resize-none rounded-xl border px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-300"
                    rows="1"></textarea>
                  <button id="sendBtn" class="rounded-xl border px-4 py-2 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800">Senden</button>
                </div>
                <div class="mt-2 flex flex-wrap gap-2 text-xs">
                  <button class="rounded-full border px-3 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 ex-btn" data-ex="Guten Tag, wie geht es dir?">Beispiel 1</button>
                  <button class="rounded-full border px-3 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 ex-btn" data-ex="Ich habe das nicht gewusst.">Beispiel 2</button>
                  <button class="rounded-full border px-3 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 ex-btn" data-ex="Das ist sehr gut!">Beispiel 3</button>
                </div>
              </div>
            </div>
            <!-- Audio Mock -->
            <div class="card glass ringed p-4">
              <div class="flex flex-wrap items-center gap-2">
                <button id="recBtn" class="shine transition rounded-xl border px-4 py-2 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800">Aufnahme starten (Mock)</button>
                <button id="sttBtn" class="shine transition rounded-xl border px-4 py-2 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800">Transkribieren (Mock STT)</button>
                <button id="ttsBtn" class="shine transition rounded-xl border px-4 py-2 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800">Abspielen (Mock TTS)</button>
              </div>
              <div class="mt-4 grid md:grid-cols-2 gap-3 text-sm">
                <div>
                  <div class="text-xs text-gray-500 mb-1">Whisper‑Text (Mock)</div>
                  <div id="sttText" class="rounded-xl border p-3 bg-white min-h-[64px]">—</div>
                </div>
                <div>
                  <div class="text-xs text-gray-500 mb-1">Kärntnerisch</div>
                  <div id="dialektText" class="rounded-xl border p-3 bg-amber-50 min-h-[64px]">—</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Panel: Dialekt‑Chat -->
        <div id="panelChat" class="hidden">
          <div class="rounded-3xl border shadow-sm overflow-hidden bg-white/70 dark:bg-gray-900/40">
            <div class="p-4 border-b bg-gray-50/60 dark:bg-gray-900/40 flex items-center justify-between">
              <div class="font-semibold">Dialekt‑Chat</div>
              <div class="text-xs text-gray-500">Stell Fragen – der Bot antwortet logisch im Dialekt</div>
            </div>
            <div id="chatMsgs" class="p-4 space-y-3 max-h-[420px] overflow-auto">
              <div class="mx-auto text-xs text-gray-500">Frag wos – i probier gscheit zu antwortn (im Dialekt).</div>
            </div>
            <div class="p-3 border-t bg-white/60 dark:bg-gray-900/40">
              <div class="flex gap-2">
                <textarea id="chatInput" placeholder="Dei Frog …" class="flex-1 resize-none rounded-xl border px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-amber-300" rows="1"></textarea>
                <button id="chatSend" class="rounded-xl border px-4 py-2 text-sm font-semibold hover:bg-gray-50 dark:hover:bg-gray-800">Senden</button>
              </div>
              <div class="mt-2 flex flex-wrap gap-2 text-xs">
                <button class="rounded-full border px-3 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 chat-ex" data-ex="Wie geht's dir heute?">Wie geht's?</button>
                <button class="rounded-full border px-3 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 chat-ex" data-ex="Was ist das Wetter in Villach?">Wetter</button>
                <button class="rounded-full border px-3 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 chat-ex" data-ex="Wo kann ich heute gut essen?">Tipp</button>
                <button class="rounded-full border px-3 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 chat-ex" data-ex="Kannst du mir bei der Aufgabe helfen?">Hilfe</button>
                <button class="rounded-full border px-3 py-1 hover:bg-gray-50 dark:hover:bg-gray-800 chat-ex" data-ex="Hast du einen Motivationstipp fürs Studium?">Motivation</button>
              </div>
            </div>
          </div>
          <!-- Kleine Wissens-Kacheln -->
          <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-6 text-sm">
            <div class="card glass ringed p-4">
              <div class="font-semibold mb-1">Beispiele, die gut funktionieren</div>
              <ul class="list-disc pl-5 space-y-1 text-gray-600 dark:text-gray-300">
                <li>„Was mach i heut in Villach?“</li>
                <li>„Hast a Lokal‑Empfehlung?“</li>
                <li>„Kannst ma bei Mathe helfen?“</li>
                <li>„Wie lern i gscheit fürs Examen?“</li>
              </ul>
            </div>
            <div class="card glass ringed p-4">
              <div class="font-semibold mb-1">Stil</div>
              <p class="text-gray-600 dark:text-gray-300">Mittelkärntnerisch, freundlich‑direkt, kurze Sätze, praxisnah.</p>
            </div>
            <div class="card glass ringed p-4">
              <div class="font-semibold mb-1">Grenzen</div>
              <p class="text-gray-600 dark:text-gray-300">Kein Internetzugriff, keine echten Buchungen, Antworten sind heuristisch.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Features -->
  <section id="features" class="relative py-16">
    <div class="absolute inset-0 grid-bg"></div>
    <div class="relative max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl sm:text-3xl font-bold tracking-tight">Kern‑Features</h2>
      <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Was die finale Version liefert</p>
      <div class="mt-6 grid sm:grid-cols-2 lg:grid-cols-3 gap-4 text-sm">
        <div class="card glass ringed p-4">
          <div class="font-semibold">Bidirektionale Kommunikation</div>
          <p class="mt-1 text-gray-600 dark:text-gray-300">Text & Sprache in beide Richtungen. Live oder Batch.</p>
        </div>
        <div class="card glass ringed p-4">
          <div class="font-semibold">Dialekt‑Korpus + Regelwerk</div>
          <p class="mt-1 text-gray-600 dark:text-gray-300">Eigene Datenbasis mit Varianten (Mittelkärnten), phonetische Regeln.</p>
        </div>
        <div class="card glass ringed p-4">
          <div class="font-semibold">LLM‑Steuerung</div>
          <p class="mt-1 text-gray-600 dark:text-gray-300">Prompt‑Templates, systematische Kontrollen, deterministischere Ausgaben.</p>
        </div>
        <div class="card glass ringed p-4">
          <div class="font-semibold">Echtzeit‑Pipeline</div>
          <p class="mt-1 text-gray-600 dark:text-gray-300">WebSocket‑Streaming (Audio/Text), Latenzziele & Messung.</p>
        </div>
        <div class="card glass ringed p-4">
          <div class="font-semibold">Evaluation</div>
          <p class="mt-1 text-gray-600 dark:text-gray-300">WER/CER (STT), MOS/UMOS (TTS), UX‑Fragebogen.</p>
        </div>
        <div class="card glass ringed p-4">
          <div class="font-semibold">Datenschutz</div>
          <p class="mt-1 text-gray-600 dark:text-gray-300">Keine Speicherung von Roh‑Audio, Logs anonymisiert, Keys nur Backend.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Technik -->
  <section id="technik" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
    <h2 class="text-2xl sm:text-3xl font-bold tracking-tight">Technik‑Stack</h2>
    <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Festgelegte Entscheidungen für das MVP</p>
    <div class="mt-6 grid md:grid-cols-2 gap-6 text-sm">
      <div class="card glass ringed p-4">
        <div class="font-semibold">Pipeline</div>
        <ul class="mt-2 list-disc pl-5 space-y-1 text-gray-600 dark:text-gray-300">
          <li>STT: <strong>Whisper</strong> (lokal für Batch, optional Realtime Fallback Deepgram)</li>
          <li>LLM: <strong>GPT‑4</strong> via Backend‑Proxy + Dialekt‑Regelwerk</li>
          <li>TTS: <strong>ElevenLabs</strong> Realtime, Fallback Piper offline</li>
          <li>Frontend: Static/Vanilla</li>
          <li>Backend: Node.js + Express, WebSocket für Streaming</li>
        </ul>
      </div>
      <div class="card glass ringed p-4">
        <div class="font-semibold">Sicherheit & Privacy</div>
        <ul class="mt-2 list-disc pl-5 space-y-1 text-gray-600 dark:text-gray-300">
          <li>Keine Speicherung von Audiodaten</li>
          <li>Anonymisierte Logs, Rate Limits</li>
          <li>API‑Keys ausschließlich im Backend</li>
          <li>CORS für definierte Origins</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Evaluation -->
  <section id="evaluation" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
    <h2 class="text-2xl sm:text-3xl font-bold tracking-tight">Evaluation & KPIs</h2>
    <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Wie wir Qualität nachweisen</p>
    <div class="mt-6 grid md:grid-cols-3 gap-4 text-sm">
      <div class="card glass ringed p-4"><div class="font-semibold">STT‑Genauigkeit</div><p class="mt-1">WER/CER auf 20–30 Sätzen (HD + Dialekt). Ziel: WER &lt; 12%.</p></div>
      <div class="card glass ringed p-4"><div class="font-semibold">TTS‑Natürlichkeit</div><p class="mt-1">MOS/UMOS mit 15–25 Testhörer:innen. Ziel: MOS ≥ 4.0.</p></div>
      <div class="card glass ringed p-4"><div class="font-semibold">UX‑Metriken</div><p class="mt-1">Verständlichkeit, Authentizität, Latenz‑Wahrnehmung, Task‑Success.</p></div>
    </div>
  </section>

  <!-- Datenschutz -->
  <section id="privacy" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-14">
    <h2 class="text-2xl sm:text-3xl font-bold tracking-tight">Datenschutz</h2>
    <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">Transparenz für Nutzer:innen</p>
    <div class="mt-6 card glass ringed p-4 text-sm">
      <p>Es werden <strong>keine Roh‑Audiodaten gespeichert</strong>. Transkripte können lokal verarbeitet werden. API‑Zugriffe laufen über einen Server‑Proxy mit Zugriffsbeschränkungen. Statistiken werden nur anonymisiert erhoben (z. B. Latenzen, Fehlerraten). Opt‑out jederzeit möglich.</p>
    </div>
  </section>

  <footer class="border-t py-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-sm text-gray-600 dark:text-gray-300">
      <div class="flex flex-wrap items-center justify-between gap-3">
        <div>© <span id="year"></span> Red ma Kärntnerisch! – Bachelorprojekt FH Kärnten</div>
        <div class="flex gap-4">
          <a href="#demo" class="hover:underline">Demo</a>
          <a href="#technik" class="hover:underline">Technik</a>
          <a href="#privacy" class="hover:underline">Privacy</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // --- Dark mode persistence ---
    (function() {
      const saved = localStorage.getItem('rk-dark') === '1';
      document.documentElement.classList.toggle('dark', saved);
      const btn = document.getElementById('darkToggle');
      btn.textContent = saved ? 'Light Mode' : 'Dark Mode';
      btn.addEventListener('click', function() {
        const isDark = document.documentElement.classList.toggle('dark');
        localStorage.setItem('rk-dark', isDark ? '1' : '0');
        this.textContent = isDark ? 'Light Mode' : 'Dark Mode';
      });
    })();

    // --- Year in footer ---
    document.getElementById('year').textContent = new Date().getFullYear();

    // --- Simple rules Hochdeutsch -> Kärntnerisch (Mock) ---
    function toKaerntnerisch(text) {
      if (!text) return '';
      const rules = [
        [/guten tag/gi, 'Grias di'],
        [/hallo/gi, 'Servas'],
        [/ich habe/gi, 'I hob'],
        [/ich hab/gi, 'I hob'],
        [/ich bin/gi, 'I bin'],
        [/du bist/gi, 'Du bist'],
        [/nicht/gi, 'ned'],
        [/kein/gi, 'koan'],
        [/klein/gi, 'klaa'],
        [/ganz/gi, 'gonz'],
        [/gut/gi, 'leiwaund'],
        [/sehr/gi, 'voll'],
        [/vielleicht/gi, 'vielleichts'],
        [/was/gi, 'wos'],
        [/wie/gi, 'wia'],
        [/auch/gi, 'aa'],
        [/euch/gi, 'enk'],
        [/euer/gi, 'eich'],
        [/mir/gi, 'ma'],
        [/dir/gi, 'da'],
        [/mit/gi, 'mitn'],
        [/ich/gi, 'I'],
        [/nicht\\s+gewusst/gi, 'ned gwusst'],
        [/sehr gut/gi, 'ur leiwaund'],
      ];
      let out = text;
      rules.forEach(([re, subst]) => { out = out.replace(re, subst); });
      return out;
    }

    // ---------- Übersetzer: chat logic ----------
    const messages = document.getElementById('messages');
    const input = document.getElementById('input');
    const sendBtn = document.getElementById('sendBtn');

    function addBubble(container, text, role) {
      const div = document.createElement('div');
      if (role === 'user') {
        div.className = 'ml-auto max-w-[85%] rounded-2xl border px-3 py-2 bg-white';
      } else if (role === 'assistant') {
        div.className = 'mr-auto max-w-[85%] rounded-2xl border px-3 py-2 bg-amber-50';
      } else {
        div.className = 'mx-auto text-xs text-gray-500';
      }
      div.textContent = text;
      container.appendChild(div);
      container.scrollTop = container.scrollHeight;
    }

    function sendMessage() {
      const t = input.value.trim();
      if (!t) return;
      addBubble(messages, t, 'user');
      input.value = '';
      const thinking = document.createElement('div');
      thinking.className = 'mr-auto max-w-[85%] rounded-2xl border px-3 py-2 text-gray-500 text-sm';
      thinking.textContent = '… denk nach';
      messages.appendChild(thinking);
      messages.scrollTop = messages.scrollHeight;
      setTimeout(() => {
        messages.removeChild(thinking);
        addBubble(messages, toKaerntnerisch(t), 'assistant');
      }, 300);
    }

    input?.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
    });
    sendBtn?.addEventListener('click', sendMessage);

    document.querySelectorAll('.ex-btn').forEach(btn => {
      btn.addEventListener('click', () => { input.value = btn.dataset.ex; input.focus(); });
    });

    // ---------- Audio mock ----------
    const recBtn = document.getElementById('recBtn');
    const sttBtn = document.getElementById('sttBtn');
    const ttsBtn = document.getElementById('ttsBtn');
    const sttText = document.getElementById('sttText');
    const dialektText = document.getElementById('dialektText');
    let recording = false;

    recBtn?.addEventListener('click', () => {
      recording = !recording;
      recBtn.textContent = recording ? '● Aufnahme läuft (Mock)' : 'Aufnahme starten (Mock)';
      recBtn.classList.toggle('bg-red-50', recording);
    });

    sttBtn?.addEventListener('click', () => {
      const t = 'Hallo, ich bin gerade in Villach und brauche eine Auskunft.';
      sttText.textContent = t;
      dialektText.textContent = toKaerntnerisch(t);
    });

    ttsBtn?.addEventListener('click', () => {
      alert('TTS (Mock) – Dialekt wird abgespielt');
    });

    // ---------- Dialekt‑Chat: intent-based logic ----------
    const chatMsgs = document.getElementById('chatMsgs');
    const chatInput = document.getElementById('chatInput');
    const chatSend = document.getElementById('chatSend');

    const lokaltipps = [
      'Geh am Drauufer spaziern und hol da a Eis – simpel, oba guat.',
      'A gscheite Hauskost beim bodenständign Wirt – Preis passt, Portionen aa.',
      'Villacher Alpenstraße auffi – Aussicht is leiwaund (wennst a Auto host).',
      'Kleiner Stadtbummel am Hauptplatz, dann Kaffee – klassisch und gemütlich.'
    ];
    const studium = [
      'Lern täglich 45–60 Minuten fokussiert, ned marathonn.',
      'Schreib da a kurze Zusammenfassung nach jeder Einheit – bleibt bessa picken.',
      'Frag de Prof früh, wenn wos unklar is – spart da Nerven.',
      'Mach 2–3 Übungsbeispiele statt 20 Seiten Theorie lesen.'
    ];

    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
    function timeNow(){ const d=new Date(); return d.toLocaleTimeString(); }
    function weekday(){ return ['Sonntag','Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag'][new Date().getDay()]; }

    function replyFor(text) {
      const t = text.toLowerCase();

      // Small knowledge base / intents
      if (/hallo|servus|gria[sß]|hi|hey/.test(t)) return 'Servas! Wos gibt’s?';
      if (/wie geht/.test(t)) return 'Jo passt, danke – a bissl stressig, oba geht scho. Wia schaugts bei da aus?';
      if (/wetter|regen|sonne|temperatur/.test(t)) return 'I bin ka Wetterfrosch, oba nimm a Joppe mit – in Kärnten wechselt’s gschwind.';
      if (/villach|klagenfurt|kärnten/.test(t)) return 'In '+(t.includes('villach')?'Villach':'Kärnten')+' geht imma wos: '+pick(lokaltipps);
      if (/essen|lokal|restaurant|mittag|mittagessen|abendessen/.test(t)) return 'I würd a bodenständign Wirt empfehlen: '+pick(lokaltipps);
      if (/hilfe|kannst du.*helfen|problem|fehler|bug/.test(t)) return 'Sicher. Erzähl gnaue – wos geht ned? Gemma Schritt für Schritt durch.';
      if (/studium|fh|prof|prüfung|lernen|examen|klausur/.test(t)) return 'Für’s Studium: '+pick(studium);
      if (/motivation|keine lust|prokrastinier/.test(t)) return 'Kloa Tipp: 10‑Minuten‑Regel. Fang klan an – meistens bleibst dann eh dabei.';
      if (/zeit|uhr|spät/.test(t)) return 'Es is grad '+timeNow()+' am '+weekday()+'. Pack zam, mach a Pause.';
      if (/danke|thx|dankeschön/.test(t)) return 'Gern gschehn! Wenn no wos is, sog einfach.';
      if (/sport|laufen|fitness|training/.test(t)) return 'A lockere 20‑Minuten‑Rundn reicht. Wichtig is: regelmäßig, ned extrem.';
      if (/projekt|chatbot|dialekt|korpus/.test(t)) return 'Fokus: Mittelkärntnerisch, klares Regelwerk und a Handvoll Beispiel‑Sätze, dann iteriern.';
      if (/idee|vorschlag|was soll ich machen/.test(t)) return 'Pick a klans Ziel für heit und bring des bis zum Ende. Danach belohn di – Kaffee oder Spaziern.';

      // Fallback
      return 'Klingt spannend. I würd sagen: mach langsam, denk a bissl nach und wennst magst, schaun ma glei drüber.';
    }

    function chatAdd(container, text, role) {
      addBubble(container, text, role);
    }

    function sendChat() {
      const t = chatInput.value.trim();
      if (!t) return;
      chatAdd(chatMsgs, t, 'user');
      chatInput.value = '';
      const thinking = document.createElement('div');
      thinking.className = 'mr-auto max-w-[85%] rounded-2xl border px-3 py-2 text-gray-500 text-sm';
      thinking.textContent = '… denk nach';
      chatMsgs.appendChild(thinking);
      chatMsgs.scrollTop = chatMsgs.scrollHeight;
      setTimeout(() => {
        chatMsgs.removeChild(thinking);
        chatAdd(chatMsgs, replyFor(t), 'assistant');
      }, 350);
    }

    chatInput?.addEventListener('keydown', (e) => { if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendChat(); } });
    chatSend?.addEventListener('click', sendChat);
    document.querySelectorAll('.chat-ex').forEach(btn => { btn.addEventListener('click', () => { chatInput.value = btn.dataset.ex; chatInput.focus(); }); });

    // --- Tabs toggle ---
    const tabTrans = document.getElementById('tabTrans');
    const tabChat = document.getElementById('tabChat');
    const panelTrans = document.getElementById('panelTrans');
    const panelChat = document.getElementById('panelChat');

    function activate(tab) {
      if (tab === 'trans') {
        tabTrans.classList.add('tab-active');
        tabChat.classList.remove('tab-active');
        panelTrans.classList.remove('hidden');
        panelChat.classList.add('hidden');
      } else {
        tabChat.classList.add('tab-active');
        tabTrans.classList.remove('tab-active');
        panelChat.classList.remove('hidden');
        panelTrans.classList.add('hidden');
      }
    }
    tabTrans?.addEventListener('click', () => activate('trans'));
    tabChat?.addEventListener('click', () => activate('chat'));
  </script>
</body>
</html>
